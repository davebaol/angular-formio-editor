<!-- Modal -->
<ng-template  #saveModal class="modal fade" tabindex="-1" role="dialog" aria-labelledby="saveModalLabel" aria-hidden="true">

  <div class="modal-header">
    <h5 class="modal-title" id="exampleModalLabel">Validation warning</h5>
    <button type="button" class="close pull-right" aria-label="Close" (click)="modalRef.hide()">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    Looks like the json is not a valid form.
    Do you want to apply changes anyways?
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-secondary" data-dismiss="modal" (click)="modalRef.hide();">NO</button>
    <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="modalRef.hide(); jsonEditorApplyChanges()">YES</button>
  </div>
</ng-template>
<ul class="nav nav-tabs" id="myTab" role="tablist">
  <li class="nav-item" *ngIf="options.tabs.includes('builder')">
    <a class="nav-link" [ngClass]="{'active':activeTab=='builder'}" (click)="activeTab='builder'"
       id="builder-tab" data-toggle="tab" href="#builder" role="tab" aria-controls="builder" aria-selected="true">
      Builder
    </a>
  </li>
  <li class="nav-item" *ngIf="options.tabs.includes('json')">
    <a class="nav-link" [ngClass]="{'active':activeTab=='json'}" (click)="activeTab='json'"
      id="json-editor-tab" data-toggle="tab" href="#json-editor" role="tab" aria-controls="json-editor"
      aria-selected="false">
      Json
    </a>
  </li>
  <li class="nav-item" *ngIf="options.tabs.includes('renderer')">
    <a class="nav-link" [ngClass]="{'active':activeTab=='renderer'}" (click)="activeTab='renderer'"
        id="renderer-tab" data-toggle="tab" href="#renderer" role="tab" aria-controls="renderer" aria-selected="false">
      Renderer
    </a>
  </li>
</ul>
<div class="tab-content" id="myTabContent">
  <div class="tab-pane fade" [ngClass]="{'show active':activeTab=='builder'}" id="builder" role="tabpanel" aria-labelledby="builder-tab">
    <div class="m-2">
      <div *ngIf="options?.builder?.hideDisplaySelect !== true">
        <label for="form-display-select" class="mx-2">Display as: </label>
        <select id="form-display-select" class="form-control my-2" style="display: inline-block; width: 150px;"
                [(ngModel)]="form.display" (ngModelChange)="onBuilderDiplayChange($event)">
          <option value="form">Form</option>
          <option value="wizard">Wizard</option>
        </select>
      </div>
      <form-builder *ngIf="!builderDisplayChanged" [form]="form" (change)="onBuilderChange($event)"></form-builder>
    </div>
  </div>
  <div class="tab-pane fade" [ngClass]="{'show active':activeTab=='json'}" id="json-editor" role="tabpanel" aria-labelledby="json-editor-tab">
    <div class="m-2 well">
      <div class="row mx-0" *ngIf="options.json.changePanelLocations.includes('top')">
        <div class="m-2 p-0">
          <button type="button" class="btn btn-success mr-4" (click)="onJsonEditorApply(saveModal)"
                  [disabled]="!jsonEditorChanged || jsonEditorErrors.length !== jsonEditorWarningCounter">
            Apply
          </button>
          <button type="button" class="btn btn-secondary" (click)="jsonEditorDiscardChanges()">Discard</button>
        </div>
        <alert class="col-6 mx-4 m-2 p-0"  type="danger" [isOpen]="jsonEditorErrors.length !== jsonEditorWarningCounter" >
          Cannot apply changes. Json is not well-formed.
        </alert>
      </div>
      <json-editor #jsoneditor [options]="jsonEditorOptions" (dataChange)="onJsonEditorChange($event)" (dataError)="onJsonEditorError($event)"></json-editor>
      <div class="row mx-0" *ngIf="options.json.changePanelLocations.includes('bottom')">
        <div class="m-2 p-0">
          <button type="button" class="btn btn-success mr-4" (click)="onJsonEditorApply(saveModal)"
                  [disabled]="!jsonEditorChanged || jsonEditorErrors.length !== jsonEditorWarningCounter">
            Apply
          </button>
          <button type="button" class="btn btn-secondary" (click)="jsonEditorDiscardChanges()">Discard</button>
        </div>
        <alert class="col-6 mx-4 my-2 p-1 align-middle" type="danger" [isOpen]="jsonEditorErrors.length !== jsonEditorWarningCounter" >
          Cannot apply changes. Json is not well-formed.
        </alert>
      </div>
    </div>
  </div>
  <div class="tab-pane fade" [ngClass]="{'show active':activeTab=='renderer'}" id="renderer" role="tabpanel" aria-labelledby="renderer-tab">
    <div class="m-2">
      <formio *ngIf="activeTab=='renderer'" [form]="form"></formio>
    </div>
  </div>
</div>

